import pandas as pd
import numpy as np

# Path to your Excel file
file_path = r'C:\your_folder\your_file.xlsx'  # Change this to your actual file path

# List of names to exclude
exclude_names = ['Test', 'Test1', 'Test2']  # Add more names as needed

# Read the Excel file (assuming data is in 'Sheet1')
df = pd.read_excel(file_path, sheet_name='Sheet1')

# Identify groups to exclude
exclude_groups = df.groupby('Group')['CreatedBy'].transform(lambda x: x.isin(exclude_names).any())

# Add the 'Decision' column
df['Decision'] = np.where(exclude_groups, 'Exclude', 'Keep')

# Save to a new Excel file
output_path = r'C:\your_folder\your_file_with_decision.xlsx'  # Change as needed
df.to_excel(output_path, index=False)

print(f"Processed file saved to {output_path}")
